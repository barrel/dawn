{"version":3,"file":"media-gallery.59bb98be.js","sources":["../frontend/components/media-gallery.js"],"sourcesContent":["import { debounce, pauseAllMedia } from '@/lib/utils';\n\nif (!customElements.get('media-gallery')) {\n  customElements.define('media-gallery', class MediaGallery extends HTMLElement {\n    constructor() {\n      super();\n      this.elements = {\n        liveRegion: this.querySelector('[id^=\"GalleryStatus\"]'),\n        viewer: this.querySelector('[id^=\"GalleryViewer\"]'),\n        thumbnails: this.querySelector('[id^=\"GalleryThumbnails\"]')\n      }\n      this.mql = window.matchMedia('(min-width: 750px)');\n      if (!this.elements.thumbnails) return;\n\n      this.elements.viewer.addEventListener('slideChanged', debounce(this.onSlideChanged.bind(this), 500));\n      this.elements.thumbnails.querySelectorAll('[data-target]').forEach((mediaToSwitch) => {\n        mediaToSwitch.querySelector('button').addEventListener('click', this.setActiveMedia.bind(this, mediaToSwitch.dataset.target, false));\n      });\n      if (this.dataset.desktopLayout !== 'stacked' && this.mql.matches) this.removeListSemantic();\n    }\n\n    onSlideChanged(event) {\n      const thumbnail = this.elements.thumbnails.querySelector(`[data-target=\"${ event.detail.currentElement.dataset.mediaId }\"]`);\n      this.setActiveThumbnail(thumbnail);\n    }\n\n    setActiveMedia(mediaId, prepend) {\n      const activeMedia = this.elements.viewer.querySelector(`[data-media-id=\"${ mediaId }\"]`);\n      this.elements.viewer.querySelectorAll('[data-media-id]').forEach((element) => {\n        element.classList.remove('is-active');\n      });\n      activeMedia.classList.add('is-active');\n\n      if (prepend) {\n        activeMedia.parentElement.prepend(activeMedia);\n        if (this.elements.thumbnails) {\n          const activeThumbnail = this.elements.thumbnails.querySelector(`[data-target=\"${ mediaId }\"]`);\n          activeThumbnail.parentElement.prepend(activeThumbnail);\n        }\n        if (this.elements.viewer.slider) this.elements.viewer.resetPages();\n      }\n\n      this.preventStickyHeader();\n      window.setTimeout(() => {\n        if (this.elements.thumbnails) {\n          activeMedia.parentElement.scrollTo({ left: activeMedia.offsetLeft });\n        }\n        if (!this.elements.thumbnails || this.dataset.desktopLayout === 'stacked') {\n          activeMedia.scrollIntoView({behavior: 'smooth'});\n        }\n      });\n      this.playActiveMedia(activeMedia);\n\n      if (!this.elements.thumbnails) return;\n      const activeThumbnail = this.elements.thumbnails.querySelector(`[data-target=\"${ mediaId }\"]`);\n      this.setActiveThumbnail(activeThumbnail);\n      this.announceLiveRegion(activeMedia, activeThumbnail.dataset.mediaPosition);\n    }\n\n    setActiveThumbnail(thumbnail) {\n      if (!this.elements.thumbnails || !thumbnail) return;\n\n      this.elements.thumbnails.querySelectorAll('button').forEach((element) => element.removeAttribute('aria-current'));\n      thumbnail.querySelector('button').setAttribute('aria-current', true);\n      if (this.elements.thumbnails.isSlideVisible(thumbnail, 10)) return;\n\n      this.elements.thumbnails.slider.scrollTo({ left: thumbnail.offsetLeft });\n    }\n\n    announceLiveRegion(activeItem, position) {\n      const image = activeItem.querySelector('.product__modal-opener--image img');\n      if (!image) return;\n      image.onload = () => {\n        this.elements.liveRegion.setAttribute('aria-hidden', false);\n        this.elements.liveRegion.innerHTML = window.accessibilityStrings.imageAvailable.replace(\n          '[index]',\n          position\n        );\n        setTimeout(() => {\n          this.elements.liveRegion.setAttribute('aria-hidden', true);\n        }, 2000);\n      };\n      image.src = image.src;\n    }\n\n    playActiveMedia(activeItem) {\n      pauseAllMedia();\n      const deferredMedia = activeItem.querySelector('.deferred-media');\n      if (deferredMedia) deferredMedia.loadContent(false);\n    }\n\n    preventStickyHeader() {\n      this.stickyHeader = this.stickyHeader || document.querySelector('sticky-header');\n      if (!this.stickyHeader) return;\n      this.stickyHeader.dispatchEvent(new Event('preventHeaderReveal'));\n    }\n\n    removeListSemantic() {\n      if (!this.elements.viewer.slider) return;\n      this.elements.viewer.slider.setAttribute('role', 'presentation');\n      this.elements.viewer.sliderItems.forEach(slide => slide.setAttribute('role', 'presentation'));\n    }\n  });\n}\n"],"names":[],"mappings":"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"}