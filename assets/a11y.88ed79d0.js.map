{"version":3,"file":"a11y.88ed79d0.js","sources":["../frontend/lib/a11y.js"],"sourcesContent":["function getFocusableElements(container) {\n  return Array.from(\n    container.querySelectorAll(\n      \"summary, a[href], button:enabled, [tabindex]:not([tabindex^='-']), [draggable], area, input:not([type=hidden]):enabled, select:enabled, textarea:enabled, object, iframe\"\n    )\n  );\n}\n\ndocument.querySelectorAll('[id^=\"Details-\"] summary').forEach((summary) => {\n  summary.setAttribute('role', 'button');\n  summary.setAttribute('aria-expanded', summary.parentNode.hasAttribute('open'));\n\n  if(summary.nextElementSibling.getAttribute('id')) {\n    summary.setAttribute('aria-controls', summary.nextElementSibling.id);\n  }\n\n  summary.addEventListener('click', (event) => {\n    event.currentTarget.setAttribute('aria-expanded', !event.currentTarget.closest('details').hasAttribute('open'));\n  });\n\n  if (summary.closest('header-drawer')) return;\n  summary.parentElement.addEventListener('keyup', onKeyUpEscape);\n});\n\n\nconst trapFocusHandlers = {};\n\nexport function trapFocus(container, elementToFocus = container) {\n  var elements = getFocusableElements(container);\n  var first = elements[0];\n  var last = elements[elements.length - 1];\n\n  removeTrapFocus();\n\n  trapFocusHandlers.focusin = (event) => {\n    if (\n      event.target !== container &&\n      event.target !== last &&\n      event.target !== first\n    )\n      return;\n\n    document.addEventListener('keydown', trapFocusHandlers.keydown);\n  };\n\n  trapFocusHandlers.focusout = function() {\n    document.removeEventListener('keydown', trapFocusHandlers.keydown);\n  };\n\n  trapFocusHandlers.keydown = function(event) {\n    if (event.code.toUpperCase() !== 'TAB') return; // If not TAB key\n    // On the last focusable element and tab forward, focus the first element.\n    if (event.target === last && !event.shiftKey) {\n      event.preventDefault();\n      first.focus();\n    }\n\n    //  On the first focusable element and tab backward, focus the last element.\n    if (\n      (event.target === container || event.target === first) &&\n      event.shiftKey\n    ) {\n      event.preventDefault();\n      last.focus();\n    }\n  };\n\n  document.addEventListener('focusout', trapFocusHandlers.focusout);\n  document.addEventListener('focusin', trapFocusHandlers.focusin);\n\n  elementToFocus.focus();\n}\n\n// Here run the querySelector to figure out if the browser supports :focus-visible or not and run code based on it.\ntry {\n  document.querySelector(\":focus-visible\");\n} catch(e) {\n  focusVisiblePolyfill();\n}\n\nfunction focusVisiblePolyfill() {\n  const navKeys = ['ARROWUP', 'ARROWDOWN', 'ARROWLEFT', 'ARROWRIGHT', 'TAB', 'ENTER', 'SPACE', 'ESCAPE', 'HOME', 'END', 'PAGEUP', 'PAGEDOWN']\n  let currentFocusedElement = null;\n  let mouseClick = null;\n\n  window.addEventListener('keydown', (event) => {\n    if(navKeys.includes(event.code.toUpperCase())) {\n      mouseClick = false;\n    }\n  });\n\n  window.addEventListener('mousedown', (event) => {\n    mouseClick = true;\n  });\n\n  window.addEventListener('focus', () => {\n    if (currentFocusedElement) currentFocusedElement.classList.remove('focused');\n\n    if (mouseClick) return;\n\n    currentFocusedElement = document.activeElement;\n    currentFocusedElement.classList.add('focused');\n\n  }, true);\n}\n\nexport function removeTrapFocus(elementToFocus = null) {\n  document.removeEventListener('focusin', trapFocusHandlers.focusin);\n  document.removeEventListener('focusout', trapFocusHandlers.focusout);\n  document.removeEventListener('keydown', trapFocusHandlers.keydown);\n\n  if (elementToFocus) elementToFocus.focus();\n}\n\nexport function onKeyUpEscape(event) {\n  if (event.code.toUpperCase() !== 'ESCAPE') return;\n\n  const openDetailsElement = event.target.closest('details[open]');\n  if (!openDetailsElement) return;\n\n  const summaryElement = openDetailsElement.querySelector('summary');\n  openDetailsElement.removeAttribute('open');\n  summaryElement.setAttribute('aria-expanded', false);\n  summaryElement.focus();\n}\n"],"names":[],"mappings":"AAAA,WAA8B,EAAW,CACvC,MAAO,OAAM,KACX,EAAU,iBACR,0KACD,CACL,CACA,CAEA,SAAS,iBAAiB,0BAA0B,EAAE,QAAQ,AAAC,GAAY,CAYzE,AAXA,EAAQ,aAAa,OAAQ,QAAQ,EACrC,EAAQ,aAAa,gBAAiB,EAAQ,WAAW,aAAa,MAAM,CAAC,EAE1E,EAAQ,mBAAmB,aAAa,IAAI,GAC7C,EAAQ,aAAa,gBAAiB,EAAQ,mBAAmB,EAAE,EAGrE,EAAQ,iBAAiB,QAAS,AAAC,GAAU,CAC3C,EAAM,cAAc,aAAa,gBAAiB,CAAC,EAAM,cAAc,QAAQ,SAAS,EAAE,aAAa,MAAM,CAAC,CAClH,CAAG,EAEG,GAAQ,QAAQ,eAAe,GACnC,EAAQ,cAAc,iBAAiB,QAAS,CAAa,CAC/D,CAAC,EAGD,KAAM,GAAoB,CAAA,EAEnB,WAAmB,EAAW,EAAiB,EAAW,CAC/D,GAAI,GAAW,EAAqB,CAAS,EACzC,EAAQ,EAAS,GACjB,EAAO,EAAS,EAAS,OAAS,GAEtC,IAEA,EAAkB,QAAU,AAAC,GAAU,CACrC,AACE,EAAM,SAAW,GACjB,EAAM,SAAW,GACjB,EAAM,SAAW,GAInB,SAAS,iBAAiB,UAAW,EAAkB,OAAO,CAClE,EAEE,EAAkB,SAAW,UAAW,CACtC,SAAS,oBAAoB,UAAW,EAAkB,OAAO,CACrE,EAEE,EAAkB,QAAU,SAAS,EAAO,CAC1C,AAAI,EAAM,KAAK,YAAa,IAAK,OAE7B,GAAM,SAAW,GAAQ,CAAC,EAAM,UAClC,GAAM,eAAc,EACpB,EAAM,MAAK,GAKV,GAAM,SAAW,GAAa,EAAM,SAAW,IAChD,EAAM,UAEN,GAAM,eAAc,EACpB,EAAK,MAAK,GAEhB,EAEE,SAAS,iBAAiB,WAAY,EAAkB,QAAQ,EAChE,SAAS,iBAAiB,UAAW,EAAkB,OAAO,EAE9D,EAAe,MAAK,CACtB,CAGA,GAAI,CACF,SAAS,cAAc,gBAAgB,CACzC,MAAE,CACA,GACF,CAEA,YAAgC,CAC9B,KAAM,GAAU,CAAC,UAAW,YAAa,YAAa,aAAc,MAAO,QAAS,QAAS,SAAU,OAAQ,MAAO,SAAU,UAAU,EAC1I,GAAI,GAAwB,KACxB,EAAa,KAEjB,OAAO,iBAAiB,UAAW,AAAC,GAAU,CAC5C,AAAG,EAAQ,SAAS,EAAM,KAAK,YAAa,CAAA,GAC1C,GAAa,GAEnB,CAAG,EAED,OAAO,iBAAiB,YAAa,AAAC,GAAU,CAC9C,EAAa,EACjB,CAAG,EAED,OAAO,iBAAiB,QAAS,IAAM,CAGrC,AAFI,GAAuB,EAAsB,UAAU,OAAO,SAAS,EAEvE,IAEJ,GAAwB,SAAS,cACjC,EAAsB,UAAU,IAAI,SAAS,EAE9C,EAAE,EAAI,CACT,CAEO,WAAyB,EAAiB,KAAM,CACrD,SAAS,oBAAoB,UAAW,EAAkB,OAAO,EACjE,SAAS,oBAAoB,WAAY,EAAkB,QAAQ,EACnE,SAAS,oBAAoB,UAAW,EAAkB,OAAO,EAE7D,GAAgB,EAAe,OACrC,CAEO,WAAuB,EAAO,CACnC,GAAI,EAAM,KAAK,YAAa,IAAK,SAAU,OAE3C,KAAM,GAAqB,EAAM,OAAO,QAAQ,eAAe,EAC/D,GAAI,CAAC,EAAoB,OAEzB,KAAM,GAAiB,EAAmB,cAAc,SAAS,EACjE,EAAmB,gBAAgB,MAAM,EACzC,EAAe,aAAa,gBAAiB,EAAK,EAClD,EAAe,MAAK,CACtB"}