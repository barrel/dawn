{"version":3,"file":"quick-add.19922408.js","sources":["../frontend/components/quick-add.js"],"sourcesContent":["import ModalDialog from './modal-dialog';\n\nif (!customElements.get('quick-add-modal')) {\n  customElements.define('quick-add-modal', class QuickAddModal extends ModalDialog {\n    constructor() {\n      super();\n      this.modalContent = this.querySelector('[id^=\"QuickAddInfo-\"]');\n    }\n\n    hide(preventFocus = false) {\n      const cartNotification = document.querySelector('cart-notification') || document.querySelector('cart-drawer');\n      if (cartNotification) cartNotification.setActiveElement(this.openedBy);\n      this.modalContent.innerHTML = '';\n\n      if (preventFocus) this.openedBy = null;\n      super.hide();\n    }\n\n    show(opener) {\n      opener.setAttribute('aria-disabled', true);\n      opener.classList.add('loading');\n      opener.querySelector('.loading-overlay__spinner').classList.remove('hidden');\n\n      fetch(opener.getAttribute('data-product-url'))\n        .then((response) => response.text())\n        .then((responseText) => {\n          const responseHTML = new DOMParser().parseFromString(responseText, 'text/html');\n          this.productElement = responseHTML.querySelector('section[id^=\"MainProduct-\"]');\n          this.preventDuplicatedIDs();\n          this.removeDOMElements();\n          this.setInnerHTML(this.modalContent, this.productElement.innerHTML);\n\n          if (window.Shopify && Shopify.PaymentButton) {\n            Shopify.PaymentButton.init();\n          }\n\n          if (window.ProductModel) window.ProductModel.loadShopifyXR();\n\n          this.removeGalleryListSemantic();\n          this.preventVariantURLSwitching();\n          super.show(opener);\n        })\n        .finally(() => {\n          opener.removeAttribute('aria-disabled');\n          opener.classList.remove('loading');\n          opener.querySelector('.loading-overlay__spinner').classList.add('hidden');\n        });\n    }\n\n    setInnerHTML(element, html) {\n      element.innerHTML = html;\n\n      // Reinjects the script tags to allow execution. By default, scripts are disabled when using element.innerHTML.\n      element.querySelectorAll('script').forEach(oldScriptTag => {\n        const newScriptTag = document.createElement('script');\n        Array.from(oldScriptTag.attributes).forEach(attribute => {\n          newScriptTag.setAttribute(attribute.name, attribute.value)\n        });\n        newScriptTag.appendChild(document.createTextNode(oldScriptTag.innerHTML));\n        oldScriptTag.parentNode.replaceChild(newScriptTag, oldScriptTag);\n      });\n    }\n\n    preventVariantURLSwitching() {\n      this.modalContent.querySelector('variant-radios,variant-selects').setAttribute('data-update-url', 'false');\n    }\n\n    removeDOMElements() {\n      const pickupAvailability = this.productElement.querySelector('pickup-availability');\n      if (pickupAvailability) pickupAvailability.remove();\n\n      const productModal = this.productElement.querySelector('product-modal');\n      if (productModal) productModal.remove();\n    }\n\n    preventDuplicatedIDs() {\n      const sectionId = this.productElement.dataset.section;\n      this.productElement.innerHTML = this.productElement.innerHTML.replaceAll(sectionId, `quickadd-${ sectionId }`);\n      this.productElement.querySelectorAll('variant-selects, variant-radios').forEach((variantSelect) => {\n        variantSelect.dataset.originalSection = sectionId;\n      });\n    }\n\n    removeGalleryListSemantic() {\n      const galleryList = this.modalContent.querySelector('[id^=\"Slider-Gallery\"]');\n      if (!galleryList) return;\n\n      galleryList.setAttribute('role', 'presentation');\n      galleryList.querySelectorAll('[id^=\"Slide-\"]').forEach(li => li.setAttribute('role', 'presentation'));\n    }\n  });\n}\n"],"names":[],"mappings":"sGAEA,AAAK,eAAe,IAAI,iBAAiB,GACvC,eAAe,OAAO,kBAAmB,aAA4B,EAAY,CAC/E,aAAc,CACZ,QACA,KAAK,aAAe,KAAK,cAAc,uBAAuB,CAC/D,CAED,KAAK,EAAe,GAAO,CACzB,KAAM,GAAmB,SAAS,cAAc,mBAAmB,GAAK,SAAS,cAAc,aAAa,EAC5G,AAAI,GAAkB,EAAiB,iBAAiB,KAAK,QAAQ,EACrE,KAAK,aAAa,UAAY,GAE1B,GAAc,MAAK,SAAW,MAClC,MAAM,KAAI,CACX,CAED,KAAK,EAAQ,CACX,EAAO,aAAa,gBAAiB,EAAI,EACzC,EAAO,UAAU,IAAI,SAAS,EAC9B,EAAO,cAAc,2BAA2B,EAAE,UAAU,OAAO,QAAQ,EAE3E,MAAM,EAAO,aAAa,kBAAkB,CAAC,EAC1C,KAAK,AAAC,GAAa,EAAS,KAAI,CAAE,EAClC,KAAK,AAAC,GAAiB,CACtB,KAAM,GAAe,GAAI,WAAS,EAAG,gBAAgB,EAAc,WAAW,EAC9E,KAAK,eAAiB,EAAa,cAAc,6BAA6B,EAC9E,KAAK,qBAAoB,EACzB,KAAK,kBAAiB,EACtB,KAAK,aAAa,KAAK,aAAc,KAAK,eAAe,SAAS,EAE9D,OAAO,SAAW,QAAQ,eAC5B,QAAQ,cAAc,OAGpB,OAAO,cAAc,OAAO,aAAa,cAAa,EAE1D,KAAK,0BAAyB,EAC9B,KAAK,2BAA0B,EAC/B,MAAM,KAAK,CAAM,CAC3B,CAAS,EACA,QAAQ,IAAM,CACb,EAAO,gBAAgB,eAAe,EACtC,EAAO,UAAU,OAAO,SAAS,EACjC,EAAO,cAAc,2BAA2B,EAAE,UAAU,IAAI,QAAQ,CAClF,CAAS,CACJ,CAED,aAAa,EAAS,EAAM,CAC1B,EAAQ,UAAY,EAGpB,EAAQ,iBAAiB,QAAQ,EAAE,QAAQ,GAAgB,CACzD,KAAM,GAAe,SAAS,cAAc,QAAQ,EACpD,MAAM,KAAK,EAAa,UAAU,EAAE,QAAQ,GAAa,CACvD,EAAa,aAAa,EAAU,KAAM,EAAU,KAAK,CACnE,CAAS,EACD,EAAa,YAAY,SAAS,eAAe,EAAa,SAAS,CAAC,EACxE,EAAa,WAAW,aAAa,EAAc,CAAY,CACvE,CAAO,CACF,CAED,4BAA6B,CAC3B,KAAK,aAAa,cAAc,gCAAgC,EAAE,aAAa,kBAAmB,OAAO,CAC1G,CAED,mBAAoB,CAClB,KAAM,GAAqB,KAAK,eAAe,cAAc,qBAAqB,EAClF,AAAI,GAAoB,EAAmB,SAE3C,KAAM,GAAe,KAAK,eAAe,cAAc,eAAe,EACtE,AAAI,GAAc,EAAa,QAChC,CAED,sBAAuB,CACrB,KAAM,GAAY,KAAK,eAAe,QAAQ,QAC9C,KAAK,eAAe,UAAY,KAAK,eAAe,UAAU,WAAW,EAAW,YAAa,GAAY,EAC7G,KAAK,eAAe,iBAAiB,iCAAiC,EAAE,QAAQ,AAAC,GAAkB,CACjG,EAAc,QAAQ,gBAAkB,CAChD,CAAO,CACF,CAED,2BAA4B,CAC1B,KAAM,GAAc,KAAK,aAAa,cAAc,wBAAwB,EAC5E,AAAI,CAAC,GAEL,GAAY,aAAa,OAAQ,cAAc,EAC/C,EAAY,iBAAiB,gBAAgB,EAAE,QAAQ,GAAM,EAAG,aAAa,OAAQ,cAAc,CAAC,EACrG,CACL,CAAG"}